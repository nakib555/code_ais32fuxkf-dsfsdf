/* --- START OF FILE style.css --- */
:root {
    /* Base Font & Colors (Dark Theme First) */
    --font-ui: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    --font-code: "JetBrains Mono", "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;

    --bg-app: #17191e;         /* Deep dark, almost black */
    --bg-surface: #20232a;     /* Main panels, sidebars */
    --bg-inset: #1a1c22;       /* Inputs, chat area, terminal bg */
    --bg-hover: #2c3038;       /* Subtle hover for list items, buttons */
    --bg-active: #383c46;      /* Selected items, pressed states */
    --bg-overlay: rgba(23, 25, 30, 0.85); /* More opaque overlay */

    --text-primary: #c8cdd5;   /* Slightly brighter primary text */
    --text-secondary: #848c9a;  /* Muted text, placeholders */
    --text-headings: #e6e8ed;  /* Clear headings */
    --text-on-accent: #ffffff;
    --text-link: #61afef;      /* Keeping the familiar blue link */
    --text-link-hover: #7dcff2;

    --accent-primary: #61afef; /* Blue */
    --accent-primary-hover: #7dcff2;
    --accent-primary-active: #509de2;

    --accent-secondary: #c678dd; /* Purple */
    --accent-success: #98c379;   /* Green */
    --accent-warning: #e5c07b;  /* Yellow */
    --accent-error: #e06c75;    /* Red */

    --border-color-strong: #101114; /* Between major layout sections */
    --border-color-soft: #2e323a;   /* Around inputs, UI elements */
    --border-interactive: var(--accent-primary); /* Focus rings, active tabs */

    --radius-sm: 4px;
    --radius-md: 6px;
    --radius-lg: 10px;

    --shadow-sm: 0 2px 4px rgba(0,0,0,0.2);
    --shadow-md: 0 4px 8px rgba(0,0,0,0.25);
    --shadow-lg: 0 8px 16px rgba(0,0,0,0.3);

    --spacing-unit: 8px; /* Base unit for consistent spacing */

    --header-height: 44px;
    --sidebar-initial-width: 320px;
    --file-explorer-initial-width: 280px;
    --resizer-width: 6px;
    --resizer-hover-width: 8px; /* Make resizer slightly larger on hover */
}

/* --- General Resets & Body --- */
* { box-sizing: border-box; margin: 0; padding: 0; }
html { font-size: 16px; /* Base font size for easier rem calculations */ }
body {
    font-family: var(--font-ui);
    font-size: 0.875rem; /* 14px */
    line-height: 1.6;
    background-color: var(--bg-app);
    color: var(--text-primary);
    display: flex;
    flex-direction: column;
    height: 100vh; /* Full viewport height */
    overflow: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}
.app-container { display: flex; flex-grow: 1; overflow: hidden; }

/* --- Scrollbars --- */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: var(--bg-inset); }
::-webkit-scrollbar-thumb { background: var(--bg-active); border-radius: var(--radius-md); border: 2px solid var(--bg-inset); }
::-webkit-scrollbar-thumb:hover { background: var(--bg-hover); }

/* --- Typography & Links --- */
h1, h2, h3, h4, h5, h6 { color: var(--text-headings); font-weight: 500; margin-bottom: calc(var(--spacing-unit) * 1.5); }
h2 { font-size: 1.25rem; }
h3 { font-size: 1.1rem; }
a { color: var(--text-link); text-decoration: none; transition: color 0.2s ease; }
a:hover { color: var(--text-link-hover); text-decoration: underline; }

/* --- Buttons --- */
button, .button { /* Added .button class for link-styled buttons */
    font-family: inherit;
    font-size: 0.875rem;
    padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
    border-radius: var(--radius-md);
    border: 1px solid var(--border-color-soft);
    background-color: var(--bg-surface);
    color: var(--text-primary);
    cursor: pointer;
    transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
    text-align: center;
    white-space: nowrap;
}
button:hover, .button:hover { background-color: var(--bg-hover); border-color: var(--border-interactive); }
button:active, .button:active { background-color: var(--bg-active); transform: translateY(1px); }
button:disabled, .button:disabled { opacity: 0.5; cursor: not-allowed; background-color: var(--bg-inset); }

button.primary, .button.primary, #sendChatButton {
    background-color: var(--accent-primary); border-color: var(--accent-primary); color: var(--text-on-accent); font-weight: 500;
}
button.primary:hover, .button.primary:hover, #sendChatButton:hover {
    background-color: var(--accent-primary-hover); border-color: var(--accent-primary-hover); box-shadow: 0 0 8px color-mix(in srgb, var(--accent-primary) 40%, transparent);
}
.icon-button { padding: var(--spacing-unit); line-height: 1; min-width: auto; background: transparent; border:none; color: var(--text-secondary); }
.icon-button:hover { background-color: var(--bg-hover); color: var(--text-primary); }

#setApiKeyButton {
    background-color: var(--accent-success); border-color: var(--accent-success); color: var(--text-on-accent);
}
#setApiKeyButton:hover { background-color: color-mix(in srgb, var(--accent-success) 85%, #000); border-color: color-mix(in srgb, var(--accent-success) 85%, #000); }

/* --- Inputs & Selects --- */
input[type="text"], input[type="password"], select, textarea {
    width: 100%;
    padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
    background-color: var(--bg-inset);
    border: 1px solid var(--border-color-soft);
    color: var(--text-primary);
    border-radius: var(--radius-md);
    font-size: 0.875rem;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}
input[type="text"]:focus, input[type="password"]:focus, select:focus, textarea:focus {
    outline: none;
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent-primary) 20%, transparent);
}
select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23848c9a'%3E%3Cpath d='M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right var(--spacing-unit) center;
    background-size: 1.5em;
    padding-right: calc(var(--spacing-unit) * 1.5 + 1.5em);
}
select[disabled] { opacity: 0.5; background-color: var(--bg-inset); }
.input-with-button { display: flex; gap: var(--spacing-unit); align-items: center; }
.input-with-button input { flex-grow: 1; }
.input-with-button button { flex-shrink: 0; padding: var(--spacing-unit); }

/* --- Panel Headers (Tab Bars) --- */
.panel-header { /* Common class for all tab-like headers */
    display: flex; align-items: center; background-color: var(--bg-surface);
    height: var(--header-height); padding: 0 var(--spacing-unit);
    border-bottom: 1px solid var(--border-color-strong);
    flex-shrink: 0;
}
.main-top-bar { justify-content: space-between; padding-left: calc(var(--spacing-unit) * 2); padding-right: calc(var(--spacing-unit) * 2); }
.file-explorer-tabs, .editor-file-tabs-bar, .terminal-tabs-bar { /* Use .panel-header */ }

.panel-tabs { display: flex; align-items: center; height: 100%; }
.panel-tabs button, .panel-tabs .file-tab { /* Generic tab button */
    background: none; border: none; color: var(--text-secondary);
    padding: 0 calc(var(--spacing-unit) * 1.5); height: 100%;
    cursor: pointer; font-size: 0.875rem;
    border-bottom: 3px solid transparent;
    display: flex; align-items: center; justify-content: center;
    transition: color 0.2s ease, border-color 0.2s ease, background-color 0.2s ease;
    margin-right: var(--spacing-unit);
}
.panel-tabs button:last-child, .panel-tabs .file-tab:last-child { margin-right: 0; }
.panel-tabs button:hover, .panel-tabs .file-tab:hover { color: var(--text-primary); }
.panel-tabs button.active-tab, .panel-tabs .file-tab.active-tab {
    color: var(--text-headings); border-bottom-color: var(--accent-primary); font-weight: 500;
}

/* --- Main Top Bar Specific Tab Styling (Pill Shape) --- */
.main-top-bar .panel-tabs {
    gap: calc(var(--spacing-unit) * 0.5);
    height: auto;
    padding: calc(var(--spacing-unit) * 0.5);
    border-radius: var(--radius-lg);
    background-color: var(--bg-inset);
    margin-left: calc(var(--spacing-unit) * -1);
}

.main-top-bar .panel-tabs button {
    background-color: transparent;
    border: none;
    border-radius: 999px;
    padding: calc(var(--spacing-unit) * 0.75) calc(var(--spacing-unit) * 1.5);
    color: var(--text-secondary);
    font-weight: 400;
    height: auto;
    border-bottom: none;
    margin-right: 0;
    flex-shrink: 0;
}

.main-top-bar .panel-tabs button:hover {
    background-color: var(--bg-hover);
    color: var(--text-primary);
}

.main-top-bar .panel-tabs button.active-tab {
    background-color: var(--accent-secondary);
    color: var(--text-on-accent);
    font-weight: 500;
    border-bottom: none;
}

.main-actions { display: flex; align-items: center; gap: var(--spacing-unit); }
.main-actions button {
    padding: calc(var(--spacing-unit)*0.75) var(--spacing-unit); font-size: 0.8125rem; /* 13px */
    border-color: transparent; background-color: transparent;
}
.main-actions button:hover { background-color: var(--bg-hover); border-color: var(--border-color-soft); }
.main-actions .close-button { font-size: 1.25rem; padding: calc(var(--spacing-unit)*0.5); }


/* --- AI Assistant Sidebar --- */
.ai-sidebar {
    width: var(--sidebar-initial-width); min-width: 280px; max-width: 45%;
    background-color: var(--bg-surface);
    display: flex; flex-direction: column; overflow: hidden;
    flex-shrink: 0; flex-grow: 0;
    border-right: 1px solid var(--border-color-strong);
}
.sidebar-header { padding: 0 calc(var(--spacing-unit)*2); }
.sidebar-content { padding: calc(var(--spacing-unit)*2); overflow-y: auto; flex-grow: 1; display: flex; flex-direction: column; gap: calc(var(--spacing-unit)*2); }
.config-item label { display: block; font-size: 0.8125rem; color: var(--text-secondary); margin-bottom: var(--spacing-unit); }
#chatArea {
    flex-grow: 1; background-color: var(--bg-inset); border-radius: var(--radius-md);
    padding: var(--spacing-unit); overflow-y: auto; border: 1px solid var(--border-color-soft);
    display: flex; flex-direction: column; gap: var(--spacing-unit);
}
.message {
    padding: var(--spacing-unit) calc(var(--spacing-unit)*1.5);
    border-radius: var(--radius-lg);
    max-width: 90%;
    line-height: 1.5;
    word-wrap: break-word;
    font-size: 0.875rem;
    position: relative;
    padding-bottom: calc(var(--spacing-unit) * 3); /* Space for timestamp */
}
.message-timestamp {
    position: absolute;
    bottom: calc(var(--spacing-unit) * 0.75);
    font-size: 0.7rem;
    color: var(--text-secondary);
    opacity: 0.8;
}

.user-message {
    background-color: var(--accent-primary);
    color: var(--text-on-accent);
    margin-left: auto;
    border-bottom-right-radius: var(--radius-sm);
    box-shadow: var(--shadow-sm);
    border-right: 3px solid var(--accent-primary-active);
    padding-right: calc(var(--spacing-unit) * 1.5 + 3px);
}
.user-message .message-timestamp {
    left: calc(var(--spacing-unit) * 1.5);
    right: auto;
}

.ai-message {
    background-color: var(--bg-surface);
    color: var(--text-primary);
    margin-right: auto;
    border-bottom-left-radius: var(--radius-sm);
    box-shadow: var(--shadow-sm);
    border-left: 3px solid var(--accent-secondary);
    /* Adjust padding for messages containing code blocks */
    padding: var(--spacing-unit); /* Reset padding */
    padding-left: calc(var(--spacing-unit) + 3px); /* Add border width to left padding */
    padding-right: var(--spacing-unit);
    padding-bottom: calc(var(--spacing-unit) * 2.5); /* Space for timestamp */
}
/* Specific padding adjustment for ai-message content */
.ai-message > *:not(.ai-code-block-container):not(.ai-terminal-command-block):not(.message-timestamp) {
    padding-left: calc(var(--spacing-unit) * 0.5); /* Add some left padding to text elements */
    padding-right: calc(var(--spacing-unit) * 0.5); /* Add some right padding to text elements */
}
.ai-message > h1, .ai-message > h2, .ai-message > h3, .ai-message > h4, .ai-message > h5, .ai-message > h6,
.ai-message > p, .ai-message > ul, .ai-message > ol, .ai-message > blockquote {
     padding-left: calc(var(--spacing-unit) * 0.5);
     padding-right: calc(var(--spacing-unit) * 0.5);
}
.ai-message .message-timestamp {
    right: var(--spacing-unit); /* Adjust timestamp position */
    left: auto;
    bottom: var(--spacing-unit);
}


.ai-message.info, .ai-message.thinking, .ai-message.error {
    background-color: transparent;
    box-shadow: none;
    color: var(--text-secondary);
    font-style: italic;
    font-size: 0.8125rem;
    text-align: center;
    padding: var(--spacing-unit) 0; /* Reset padding as no timestamp needed */
    border-left: 3px solid var(--text-secondary); /* Muted border */
    padding-left: calc(var(--spacing-unit) * 1.5 + 3px);
    padding-right: calc(var(--spacing-unit) * 1.5);
}
.ai-message.info.success { color: var(--accent-success); font-style: normal; border-left-color: var(--accent-success); }
.ai-message.thinking { color: var(--text-secondary); font-style: italic; background-color: transparent; box-shadow: none; }
.ai-message.error { background-color: var(--accent-error); color: var(--text-on-accent); box-shadow: var(--shadow-sm); border-left-color: var(--accent-error); font-style: normal; text-align: left; padding-left: calc(var(--spacing-unit) * 1.5); padding-right: calc(var(--spacing-unit) * 1.5);}


.sidebar-footer { padding: calc(var(--spacing-unit)*1.5); border-top: 1px solid var(--border-color-strong); flex-shrink: 0; }
.chat-input-area { display: flex; gap: var(--spacing-unit); }
#chatInput { flex-grow: 1; }
#sendChatButton.icon-button { font-size: 1.25rem; padding: var(--spacing-unit); background-color: var(--accent-primary); color: var(--text-on-accent); border: 1px solid var(--accent-primary);}
#sendChatButton.icon-button:hover { background-color: var(--accent-primary-hover); border-color: var(--accent-primary-hover); }


/* --- Main Content Wrapper & Panes --- */
.main-content-wrapper { display: flex; flex-direction: column; flex-grow: 1; overflow: hidden; }
.editor-pane-content {
    display: flex;
    position: relative;
    flex-grow: 1;
    overflow: hidden;
}

.content-pane {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--bg-surface);
    display: flex;
    flex-direction: column;
    transition: transform 0.35s cubic-bezier(0.25, 0.8, 0.25, 1), opacity 0.35s cubic-bezier(0.25, 0.8, 0.25, 1);
    z-index: 1;
    visibility: hidden; /* Default to hidden */
    opacity: 0; /* Default to transparent */
}

.content-pane.slide-from-right-init,
.content-pane.slide-from-left-init {
    visibility: visible; /* Make it visible so transform can be applied for animation start */
    opacity: 0; /* Still transparent before sliding in */
}
.content-pane.slide-from-right-init { transform: translateX(100%); }
.content-pane.slide-from-left-init { transform: translateX(-100%); }


.content-pane.active-pane {
    transform: translateX(0);
    z-index: 10;
    visibility: visible; /* Make it visible */
    opacity: 1; /* Make it opaque */
}

.content-pane.slide-to-left {
    transform: translateX(-100%);
    opacity: 0;
    visibility: hidden; /* Hide after sliding out */
}
.content-pane.slide-to-right {
    transform: translateX(100%);
    opacity: 0;
    visibility: hidden; /* Hide after sliding out */
}


/* Code Pane Specifics */
#codePane { /* This is a .content-pane, so above rules apply */
    flex-direction: row; /* Override .content-pane's flex-direction: column */
    background-color: transparent; /* Let children define background */
}
#codePane > .file-explorer-wrapper,
#codePane > .code-editor-area-wrapper {
    height: 100%; /* Fill the height of the codePane */
}
#codePane > .resizer-horizontal { /* This is the resizer between explorer and editor */
    height: 100%;
}


/* File Explorer */
.file-explorer-wrapper {
    width: var(--file-explorer-initial-width); min-width: 200px; max-width: 40%;
    background-color: var(--bg-surface);
    display: flex; flex-direction: column; flex-shrink: 0; flex-grow: 0; overflow: hidden;
    border-right: 1px solid var(--border-color-strong);
}
.file-explorer { overflow-y: auto; padding: var(--spacing-unit); flex-grow: 1; }
#fileList { list-style-type: none; } #fileList ul { padding-left: var(--spacing-unit); }
#fileList li {
    padding: calc(var(--spacing-unit)*0.75) var(--spacing-unit); cursor: pointer; font-size: 0.8125rem;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    border-radius: var(--radius-sm); color: var(--text-secondary);
    transition: background-color 0.15s ease, color 0.15s ease;
}
#fileList li:hover { background-color: var(--bg-hover); color: var(--text-primary); }
#fileList li.selected { background-color: var(--accent-primary) !important; color: var(--text-on-accent) !important; font-weight: 500; }
.file-explorer-item-content { display: flex; align-items: center; width: 100%; }
.file-explorer-chevron { margin-right: calc(var(--spacing-unit)*0.5); width: 16px; display: inline-block; text-align: center; user-select: none; transition: transform 0.2s ease; }
#fileList li[data-isdir="true"].open > .file-explorer-item-content > .file-explorer-chevron { transform: rotate(90deg); }
.file-explorer-icon { margin-right: var(--spacing-unit); user-select: none; opacity: 0.7; }

/* Code Editor */
.code-editor-area-wrapper { flex-grow: 1; display: flex; flex-direction: column; overflow: hidden; background-color: var(--bg-inset); }
.editor-file-tabs-bar { justify-content: flex-start; }
.editor-file-tabs-bar .file-tab { border-right: 1px solid var(--border-color-soft); }
.editor-file-tabs-bar .file-tab:not(.active-tab) { background-color: transparent; }
.editor-file-tabs-bar .file-tab.active-tab { background-color: var(--bg-inset); border-bottom-color: var(--accent-primary); }
.file-tab span { margin-right: var(--spacing-unit); }
.file-tab .close-file-tab {
    background:none; border:none; color:var(--text-secondary); cursor:pointer;
    padding:calc(var(--spacing-unit)*0.5); border-radius:var(--radius-sm); font-size: 1rem; line-height: 1; margin-left: var(--spacing-unit);
}
.file-tab .close-file-tab:hover { background-color:var(--bg-hover); color:var(--text-primary); }
.code-editor-content { flex-grow: 1; overflow: auto; position: relative; }
pre[class*="language-"] {
    margin: 0 !important; background-color: var(--bg-inset) !important;
    font-family: var(--font-code) !important; font-size: 0.875rem !important;
    line-height: 1.6 !important; padding: var(--spacing-unit) !important; height: 100%;
    box-sizing: border-box;
}
pre[class*="language-"].line-numbers { padding-left: 3.8em !important; }
.line-numbers .line-numbers-rows {
    border-right: 1px solid var(--border-color-soft) !important; background-color: var(--bg-inset) !important;
    padding-top: var(--spacing-unit) !important; top: 0 !important; font-size: 0.8125rem !important;
}
.line-numbers-rows > span:before { color: var(--text-secondary) !important; opacity: 0.7; }
pre[class*="language-"] code { color: var(--text-primary); white-space: pre !important; }


/* Diff Pane Styles */
.diff-header {
    justify-content: space-between;
    padding: 0 calc(var(--spacing-unit) * 1.5);
    align-items: center;
}
.diff-file-info {
    display: flex;
    align-items: center;
    gap: var(--spacing-unit);
    color: var(--text-secondary);
    font-size: 0.875rem;
    overflow: hidden; /* For long file paths */
}
#diffFilePathHeader { /* Corrected ID from #diffFilePath to #diffFilePathHeader */
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 400px; /* Adjust as needed */
    display: inline-block; /* For ellipsis to work */
}
.diff-status-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-unit);
}
.diff-status {
    font-size: 0.8125rem;
    padding: calc(var(--spacing-unit)*0.5) var(--spacing-unit);
    border-radius: var(--radius-sm);
    font-weight: 500;
}
.diff-status.no-changes {
    background-color: color-mix(in srgb, var(--accent-success) 20%, transparent);
    color: var(--accent-success);
    border: 1px solid color-mix(in srgb, var(--accent-success) 40%, transparent);
}
.diff-status.has-changes { /* Example for when changes exist */
    background-color: color-mix(in srgb, var(--accent-warning) 20%, transparent);
    color: var(--accent-warning);
    border: 1px solid color-mix(in srgb, var(--accent-warning) 40%, transparent);
}

.pane-content-area {
    flex-grow: 1;
    overflow-y: auto; /* Main scroll for the pane */
    display: flex;
    flex-direction: column;
    background-color: var(--bg-app);
    padding: var(--spacing-unit);
}

.diff-placeholder {
    display: flex; /* Initially flex, JS will control */
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    color: var(--text-secondary);
    padding: calc(var(--spacing-unit) * 3) 0; /* Give it some space */
    flex-shrink: 0; /* Don't shrink if content below is large */
}
.diff-placeholder .diff-icon {
    font-size: 3rem;
    margin-bottom: var(--spacing-unit);
    color: var(--accent-success);
}
.diff-placeholder h3 {
    color: var(--text-headings);
    margin-bottom: calc(var(--spacing-unit) * 0.5);
}

.diff-current-content-label {
    font-size: 0.875rem;
    color: var(--text-secondary);
    margin-bottom: var(--spacing-unit);
    padding-left: var(--spacing-unit); /* Align with content padding */
}

.diff-current-content-viewer {
    flex-grow: 1; /* Allow this to take remaining space and scroll */
    overflow: auto; /* For the pre/code block itself */
    background-color: var(--bg-inset) !important;
    border: 1px solid var(--border-color-soft) !important;
    border-radius: var(--radius-md);
    min-height: 200px; /* Ensure it's visible even with little content */
}
.diff-current-content-viewer pre {
    margin: 0 !important;
    height: 100%; /* Fill the viewer */
    font-size: 0.8125rem !important; /* Slightly smaller for diff view */
    background-color: var(--bg-inset) !important;
}
.diff-current-content-viewer pre.line-numbers {
    padding-left: 3.8em !important; /* Consistent with main editor */
}
.diff-current-content-viewer .line-numbers .line-numbers-rows {
    border-right: 1px solid var(--border-color-soft) !important;
    background-color: var(--bg-inset) !important; /* Match pre background */
    padding-top: var(--spacing-unit) !important;
    top: 0 !important;
    font-size: 0.75rem !important; /* Smaller line numbers */
}
.diff-current-content-viewer .line-numbers-rows > span:before {
    color: var(--text-secondary) !important;
    opacity: 0.7;
}
.diff-current-content-viewer code {
    color: var(--text-primary);
    white-space: pre !important; /* Ensure preformatting is respected */
}


#diffInternalOutput { /* Corrected ID from #diffOutput to #diffInternalOutput */
    display: none; /* Hidden by default, JS will control */
    width:100%;
    font-family: var(--font-code);
    font-size: 0.875rem;
    line-height: 1.6;
    margin-top: var(--spacing-unit); /* Space from placeholder or current content */
}
.diff-line-numbers { padding-right: var(--spacing-unit); text-align: right; color: var(--text-secondary); user-select: none;}
.diff-lines-content span { display: block; white-space: pre; }
.diff-context { color: var(--text-primary); }
.diff-addition { background-color: color-mix(in srgb, var(--accent-success) 15%, transparent); color: var(--accent-success); }
.diff-deletion { background-color: color-mix(in srgb, var(--accent-error) 15%, transparent); color: var(--accent-error); text-decoration: line-through; }


/* Preview Pane Styles */
.preview-header {
    justify-content: space-between;
    align-items: center;
    padding: 0 var(--spacing-unit);
}
.preview-nav-controls, .preview-actions {
    display: flex;
    align-items: center;
    gap: calc(var(--spacing-unit) * 0.5);
}
.preview-url-input {
    flex-grow: 1;
    margin: 0 var(--spacing-unit);
    background-color: var(--bg-inset);
    border: 1px solid var(--border-color-soft);
    color: var(--text-primary);
    border-radius: var(--radius-sm);
    padding: calc(var(--spacing-unit)*0.75) var(--spacing-unit);
    font-size: 0.8125rem;
}
.preview-url-input:focus {
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 2px color-mix(in srgb, var(--accent-primary) 20%, transparent);
}
.preview-content-area { /* pane-content-area already has flex-grow, display:flex, flex-direction:column */
    align-items: center;
    justify-content: center;
    padding: 0; /* Remove padding if iframe is to be edge-to-edge */
}
.preview-placeholder {
    display: none; /* JS will control this */
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    color: var(--text-secondary);
    height: 100%;
    width: 100%; /* Ensure it takes full space if no iframe */
    font-size: 0.9rem;
}

#previewInternalIframe { /* Corrected ID from #previewIframe to #previewInternalIframe */
    display: none; /* JS will control this */
    width:100%;
    height: 100%;
    border:none;
    background-color: var(--bg-app); /* Default to app background, content will override */
}


/* Terminal Pane */
.terminal-pane {
    height: 250px; min-height: 80px; background-color: var(--bg-inset);
    display: flex; flex-direction: column; border-top: 1px solid var(--border-color-strong);
    flex-shrink: 0; overflow: hidden;
}
.terminal-tabs-bar { cursor: ns-resize; }
.terminal-tabs-bar button:last-child.icon-button { margin-left: auto; }
.terminal-content { flex-grow: 1; padding: var(--spacing-unit); overflow: hidden; }
.xterm .xterm-viewport { background-color: var(--bg-inset) !important; }
.xterm .xterm-rows > div { font-variant-ligatures: none; }

/* Status Bar */
.status-bar {
    background-color: var(--bg-surface); color: var(--text-secondary);
    border-top: 1px solid var(--border-color-strong); padding: calc(var(--spacing-unit)*0.5) calc(var(--spacing-unit)*2);
    font-size: 0.75rem; display: flex; gap: calc(var(--spacing-unit)*2); height: calc(var(--spacing-unit)*3);
    align-items: center; flex-shrink: 0;
}
.status-bar span:first-child { color: var(--text-primary); font-weight: 500; }

/* --- Resizer Styles --- */
.resizer {
    background-color: var(--border-color-strong);
    opacity: 1;
    z-index: 100;
    transition: background-color 0.2s ease;
    flex-shrink: 0; flex-grow: 0;
    position: relative;
}
.resizer::before {
    content: ''; position: absolute;
    top: -3px; bottom: -3px; left: -3px; right: -3px;
}
.resizer:hover, .resizer.resizing { background-color: var(--accent-primary); }
.resizer-horizontal { width: var(--resizer-width); height: 100%; cursor: col-resize; }
.resizer-horizontal::before { top: 0; bottom: 0; }


/* --- AI Message Markdown & Custom Block Styling --- */
.ai-message h1, .ai-message h2, .ai-message h3, .ai-message h4, .ai-message h5, .ai-message h6 {
    color: var(--text-headings); margin-top: var(--spacing-unit);
    margin-bottom: calc(var(--spacing-unit)*0.75); line-height: 1.3;
}
.ai-message h1 { font-size: 1.25em; } .ai-message h2 { font-size: 1.1em; } .ai-message h3 { font-size: 1em; font-weight: 600; }
.ai-message p { margin-bottom: var(--spacing-unit); }
.ai-message ul, .ai-message ol { margin-left: calc(var(--spacing-unit)*2.5); margin-bottom: var(--spacing-unit); padding-left: var(--spacing-unit); }
.ai-message li { margin-bottom: calc(var(--spacing-unit)*0.5); }
.ai-message blockquote {
    border-left: 4px solid var(--accent-primary); margin-left: 0;
    padding-left: var(--spacing-unit); color: var(--text-secondary);
    font-style: italic; margin-bottom: var(--spacing-unit);
}
.ai-message > code, .ai-message p > code, .ai-message li > code { /* Inline code */
    background-color: var(--bg-inset); padding: 0.2em 0.4em;
    border-radius: var(--radius-sm); font-family: var(--font-code);
    font-size: 0.85em; color: var(--accent-secondary);
    border: 1px solid var(--border-color-soft);
}

/* Container for AI code blocks (Markdown ``` blocks) */
.ai-message .ai-code-block-container {
    background-color: var(--bg-inset); /* Or a slightly darker inset */
    border: 1px solid var(--border-color-soft);
    border-radius: var(--radius-md);
    margin: var(--spacing-unit) 0; /* Space above and below */
    overflow: hidden; /* Contains the pre and footer */
    display: flex; /* Use flex column for pre and footer */
    flex-direction: column;
}

/* Pre element inside the new container */
.ai-message .ai-code-block-container pre {
    margin: 0 !important; /* Remove default margin */
    border: none !important; /* Remove default border */
    border-radius: 0 !important; /* Remove border-radius */
    padding: var(--spacing-unit) !important; /* Keep padding inside pre */
    background-color: transparent !important; /* Inherit container background */
    flex-grow: 1; /* Allow pre to take available space */
    overflow: auto; /* Keep scrollbar for long lines */
}

/* Code element inside the new container */
.ai-message .ai-code-block-container pre code {
    background-color: transparent !important; /* Inherit */
    padding: 0 !important; /* Remove padding */
    border: none !important; /* Remove border */
    border-radius: 0 !important; /* Remove border-radius */
    white-space: pre !important; /* Ensure preformatting */
}

/* Line numbers inside the new container */
.ai-message .ai-code-block-container pre.line-numbers {
    padding-left: 3.8em !important; /* Keep space for line numbers */
}
.ai-message .ai-code-block-container .line-numbers .line-numbers-rows {
    border-right: 1px solid var(--border-color-soft) !important;
    background-color: var(--bg-inset) !important; /* Match container background */
    padding-top: var(--spacing-unit) !important; /* Match pre padding-top */
    top: 0 !important;
    font-size: 0.75rem !important; /* Smaller line numbers */
}
.ai-message .ai-code-block-container .line-numbers-rows > span:before {
    color: var(--text-secondary) !important;
    opacity: 0.7;
}


/* Footer for AI code blocks */
.ai-message .ai-code-block-footer {
    display: flex;
    align-items: center;
    justify-content: space-between; /* Space out left, center, right */
    padding: calc(var(--spacing-unit) * 0.75) var(--spacing-unit);
    background-color: color-mix(in srgb, var(--bg-inset) 80%, var(--bg-app)); /* Slightly darker than inset */
    border-top: 1px solid var(--border-color-soft);
    font-size: 0.75rem;
    color: var(--text-secondary);
    flex-shrink: 0; /* Don't shrink */
}

.ai-message .ai-code-block-footer .footer-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-unit);
}

.ai-message .ai-code-block-footer .footer-left button {
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    padding: calc(var(--spacing-unit) * 0.25); /* Smaller padding for icons */
    border-radius: var(--radius-sm);
    line-height: 1;
    font-size: 1em; /* Inherit from footer */
    transition: color 0.2s ease, background-color 0.2s ease;
}
.ai-message .ai-code-block-footer .footer-left button:hover {
    color: var(--text-primary);
    background-color: var(--bg-hover);
}

.ai-message .ai-code-block-footer .footer-center {
    flex-grow: 1; /* Take up available space */
    text-align: center;
    font-style: italic;
    color: color-mix(in srgb, var(--text-secondary) 80%, transparent); /* More muted */
}

.ai-message .ai-code-block-footer .footer-right {
    flex-shrink: 0; /* Don't shrink */
    font-family: var(--font-code);
    color: var(--text-secondary);
    opacity: 0.8;
}


/* Terminal command block styling */
.ai-message .ai-terminal-command-block,
.ai-message .ai-markdown-code-runnable-wrapper { /* Keep .ai-markdown-code-runnable-wrapper for compatibility if needed, or remove */
    margin: var(--spacing-unit) 0;
    padding: var(--spacing-unit); /* Keep padding for the block container */
    background-color: var(--bg-inset);
    border: 1px solid var(--border-color-soft);
    border-radius: var(--radius-md);
    /* Add flex properties to arrange pre and button */
    display: flex;
    flex-direction: column; /* Stack pre and button */
    gap: var(--spacing-unit); /* Space between pre and button */
}

/* Pre inside the terminal command block */
.ai-message .ai-terminal-command-block pre,
.ai-message .ai-markdown-code-runnable-wrapper pre {
    background-color: var(--bg-app) !important; /* Darker bg for command itself */
    color: var(--text-primary) !important;
    padding: var(--spacing-unit) !important;
    border-radius: var(--radius-sm) !important;
    border: 1px solid var(--border-color-strong) !important;
    font-family: var(--font-code) !important; font-size: 0.875em !important;
    white-space: pre-wrap !important; word-break: break-all;
    margin: 0 !important; /* Remove margin */
    overflow-x: auto; /* Ensure horizontal scroll if needed */
}

/* Button inside the terminal command block */
.ai-message .ai-terminal-command-block button,
.ai-message .ai-markdown-code-runnable-wrapper button {
    font-size: 0.8125rem;
    padding: calc(var(--spacing-unit)*0.75) var(--spacing-unit);
    background-color: var(--accent-secondary); border-color: var(--accent-secondary);
    color: var(--text-on-accent);
    /* Remove display: inline-block; if flex column is used */
    align-self: flex-start; /* Align button to the start */
}


/* Task List Styling */
.ai-message h2.ai-project-title {
    font-size: 1.1em;
    color: var(--text-headings);
    margin-top: calc(var(--spacing-unit) * 0.5);
    margin-bottom: var(--spacing-unit);
    padding-bottom: calc(var(--spacing-unit) * 0.75);
    border-bottom: 1px solid var(--border-color-soft);
}

.ai-message ul.ai-task-list {
    list-style-type: none;
    padding-left: 0;
    margin-top: var(--spacing-unit);
    margin-bottom: var(--spacing-unit);
}

.ai-message ul.ai-task-list li.ai-task-item {
    display: flex;
    align-items: center; /* Align items vertically */
    padding: calc(var(--spacing-unit) * 0.5) 0;
    font-size: 0.9em;
    margin-bottom: calc(var(--spacing-unit) * 0.25);
    line-height: 1.5;
    flex-wrap: wrap; /* Allow content to wrap */
    gap: calc(var(--spacing-unit) * 0.5); /* Space between items in the flex container */
}

.ai-message .ai-task-icon {
    margin-right: calc(var(--spacing-unit) * 0.5); /* Adjust margin */
    font-size: 1em;
    line-height: 1.5;
    flex-shrink: 0;
}

.ai-message .ai-task-icon.success { color: var(--accent-success); }
.ai-message .ai-task-icon.error { color: var(--accent-error); }
.ai-message .ai-task-icon.pending {
    color: var(--accent-primary);
    animation: ai-task-spinner 1.5s linear infinite;
}

.ai-message .ai-task-content {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: calc(var(--spacing-unit) * 0.5); /* Space between description and target */
    flex-grow: 1; /* Allow content to take space */
}

.ai-message .ai-task-description {
    color: var(--text-primary);
    /* margin-right: calc(var(--spacing-unit) * 0.5); */ /* Removed margin, using gap on parent */
    font-weight: 500;
    flex-shrink: 0; /* Don't shrink description */
}

.ai-message .ai-task-target {
    color: var(--text-secondary);
    font-family: var(--font-code);
    background-color: var(--bg-inset);
    padding: 0.1em 0.4em;
    border-radius: var(--radius-sm);
    font-size: 0.95em;
    word-break: break-all;
    flex-shrink: 1; /* Allow target to shrink */
    min-width: 0; /* Needed for flex-shrink to work */
}

/* Style for the button added by the backend for file tasks */
.ai-message .ai-task-item .ai-file-task-button {
    font-size: 0.75rem; /* Smaller font size */
    padding: calc(var(--spacing-unit) * 0.5) calc(var(--spacing-unit) * 1); /* Smaller padding */
    background-color: var(--bg-surface); /* Match list item background */
    border-color: var(--border-color-soft);
    color: var(--text-primary);
    flex-shrink: 0; /* Don't shrink button */
}
.ai-message .ai-task-item .ai-file-task-button:hover {
    background-color: var(--bg-hover);
    border-color: var(--accent-primary);
}


@keyframes ai-task-spinner {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}


/* --- Responsiveness --- */
@media (max-width: 1024px) {
    :root { --sidebar-initial-width: 280px; --file-explorer-initial-width: 240px; }
    .ai-sidebar { min-width: 200px; }
    .file-explorer-wrapper { min-width: 180px; }
    body { font-size: 0.8125rem; }
    .main-top-bar { padding-left: var(--spacing-unit); padding-right: var(--spacing-unit); }
    .panel-tabs button, .panel-tabs .file-tab { padding: 0 var(--spacing-unit); }
    .main-actions button { max-width: 130px; }
    .preview-url-input { min-width: 150px; }
    #diffFilePathHeader { max-width: 300px; }
}
@media (max-width: 768px) {
    .resizer-horizontal { display: none !important; }
    #codePane { flex-direction: column !important; }
    #codePane > .file-explorer-wrapper {
        width: 100% !important;
        max-width: 100% !important;
        border-right: none !important;
        border-bottom: 1px solid var(--border-color-strong) !important;
        height: 40vh !important;
        min-height: 150px !important;
        flex-grow: 0 !important;
        flex-shrink: 0 !important;
    }
    #codePane > .code-editor-area-wrapper {
        width: 100% !important;
        flex-grow: 1 !important;
        height: auto !important;
    }


    .ai-sidebar { width: var(--sidebar-initial-width); min-width: 0; max-width: 100%; border-right: 1px solid var(--border-color-strong); }
    .main-top-bar {
        padding-left: var(--spacing-unit); padding-right: var(--spacing-unit); gap: var(--spacing-unit);
        height: auto; min-height: var(--header-height); flex-wrap: wrap;
    }
    .main-top-bar .panel-tabs { margin-left: 0; padding: calc(var(--spacing-unit) * 0.5); }

    .main-tabs, .main-actions { flex-basis: 100%; justify-content: flex-start; margin-bottom: var(--spacing-unit); }
    .main-actions { margin-bottom: 0; justify-content: flex-end; }
    .panel-tabs button, .panel-tabs .file-tab, .main-actions button { font-size: 0.8125rem; }
    .main-actions button { max-width: 120px; }
    .preview-header { flex-wrap: wrap; height: auto; min-height: var(--header-height); }
    .preview-url-input { flex-basis: 100%; margin: var(--spacing-unit) 0; }
    #diffFilePathHeader { max-width: 200px; }
}
@media (max-width: 600px) {
    .app-container { flex-direction: column; }
    .ai-sidebar { width: 100%; max-width: 100%; height: 45vh; min-height: 250px; border-right: none; border-bottom: 1px solid var(--border-color-strong); }
    .main-content-wrapper { flex-grow: 1; height: 55vh; }
    .terminal-pane { height: 200px; }
    .main-tabs, .main-actions { justify-content: center; }
    #codePane > .file-explorer-wrapper { height: 35vh !important; }
    #diffFilePathHeader { max-width: 150px; }
}

/* --- THEME DEFINITIONS --- */
html.theme-light {
    --bg-app: #f4f6f8; --bg-surface: #ffffff; --bg-inset: #f8f9fa; --bg-hover: #e9ecef; --bg-active: #dee2e6;
    --text-primary: #212529; --text-secondary: #6c757d; --text-headings: #111827; --text-link: #007bff;
    --accent-primary: #007bff; --accent-primary-hover: #0069d9; --accent-primary-active: #005cbf;
    --accent-secondary: #5856d6; --accent-success: #28a745; --accent-warning: #ffc107; --accent-error: #dc3545;
    --border-color-strong: #d1d5db; --border-color-soft: #e5e7eb;
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.04); --shadow-md: 0 2px 4px rgba(0,0,0,0.05);
}
html.theme-light .ai-message { border-left-color: var(--accent-secondary); }
html.theme-light .user-message { border-right-color: var(--accent-primary-active); }
html.theme-light .ai-message.info, html.theme-light .ai-message.thinking, html.theme-light .ai-message.error { border-left-color: var(--border-color-soft); }
html.theme-light .ai-message.info.success { border-left-color: var(--accent-success); }
html.theme-light .ai-message.error { border-left-color: var(--accent-error); }


html.theme-light pre[class*="language-"] code, html.theme-light pre[class*="language-"] { color: #212529 !important; background-color: #f8f9fa !important; }
html.theme-light .line-numbers .line-numbers-rows { background-color: #f8f9fa !important; border-right-color: #e5e7eb !important; }
html.theme-light .line-numbers-rows > span:before { color: #888 !important; }
html.theme-light .ai-message > code, html.theme-light .ai-message p > code, html.theme-light li > code { background-color: #e9ecef; color: #495057; border-color: #dee2e6; }
html.theme-light .ai-message pre { background-color: #f0f2f5 !important; border-color: #d1d5db !important; }
html.theme-light .ai-message .ai-terminal-command-block, html.theme-light .ai-message .ai-markdown-code-runnable-wrapper { background-color: #f8f9fa; border-color: #e5e7eb; }
html.theme-light .ai-message .ai-terminal-command-block pre { background-color: #e9ecef !important; border-color: #d1d5db !important; }
html.theme-light .main-top-bar .panel-tabs { background-color: var(--bg-inset); }
html.theme-light .main-top-bar .panel-tabs button { color: var(--text-secondary); }
html.theme-light .main-top-bar .panel-tabs button:hover { background-color: var(--bg-hover); color: var(--text-primary); }
html.theme-light .main-top-bar .panel-tabs button.active-tab { background-color: var(--accent-secondary); color: var(--text-on-accent); }
html.theme-light .pane-content-area { background-color: var(--bg-app); color: var(--text-secondary); }
html.theme-light .diff-placeholder .diff-icon { color: var(--accent-success); }
html.theme-light .diff-placeholder h3 { color: var(--text-headings); }
html.theme-light .diff-current-content-viewer { background-color: var(--bg-inset) !important; border-color: var(--border-color-soft) !important; }
html.theme-light .diff-current-content-viewer pre { background-color: var(--bg-inset) !important; }
html.theme-light .diff-current-content-viewer code { color: var(--text-primary) !important; }
html.theme-light .diff-current-content-viewer .line-numbers .line-numbers-rows { background-color: var(--bg-inset) !important; border-right-color: var(--border-color-soft) !important; }
html.theme-light .diff-current-content-viewer .line-numbers-rows > span:before { color: var(--text-secondary) !important; }
html.theme-light .preview-header { background-color: var(--bg-surface); }
html.theme-light .preview-url-input { background-color: var(--bg-inset); border-color: var(--border-color-soft); color: var(--text-primary); }
html.theme-light .preview-url-input:focus { border-color: var(--accent-primary); }
html.theme-light .preview-header .icon-button { color: var(--text-secondary); }
html.theme-light .preview-header .icon-button:hover { color: var(--text-primary); background-color: var(--bg-hover); }
html.theme-light #previewInternalIframe { background-color: var(--bg-app); }
html.theme-light .preview-placeholder { color: var(--text-secondary); }
html.theme-light .diff-status.no-changes { background-color: color-mix(in srgb, var(--accent-success) 20%, transparent); color: var(--accent-success); border: 1px solid color-mix(in srgb, var(--accent-success) 40%, transparent); }
html.theme-light .diff-addition { background-color: #e6ffed; color: #22863a; }
html.theme-light .diff-deletion { background-color: #ffeef0; color: #b31d28; }
html.theme-light .ai-message .ai-task-description { color: var(--text-primary); }
html.theme-light .ai-message .ai-task-target { color: var(--text-secondary); background-color: var(--bg-inset); }
html.theme-light .ai-message .ai-task-icon.success { color: var(--accent-success); }
html.theme-light .ai-task-icon.error { color: var(--accent-error); }
html.theme-light .ai-task-icon.pending { color: var(--accent-primary); }
html.theme-light .ai-message h2.ai-project-title { border-bottom-color: var(--border-color-soft); }


html.theme-cosmic-dark {
    --bg-app: #0d0c1d; --bg-surface: #161b29; --bg-inset: #10141f; --bg-hover: #2a2f45; --bg-active: #3c4260;
    --text-primary: #a6b0cf; --text-secondary: #707890; --text-headings: #d0d8f0; --text-link: #79a6f2;
    --accent-primary: #79a6f2; --accent-primary-hover: #90b8ff; --accent-primary-active: #6090e0;
    --accent-secondary: #c792ea; --accent-success: #67c9a0; --accent-warning: #ffd700; --accent-error: #ff5572;
    --border-color-strong: #0a0916; --border-color-soft: #2f354d;
}
html.theme-cosmic-dark .ai-message { border-left-color: var(--accent-secondary); }
html.theme-cosmic-dark .user-message { border-right-color: var(--accent-primary-active); }
html.theme-cosmic-dark .ai-message.info, html.theme-cosmic-dark .ai-message.thinking, html.theme-cosmic-dark .ai-message.error { border-left-color: var(--text-secondary); }
html.theme-cosmic-dark .ai-message.info.success { border-left-color: var(--accent-success); }
html.theme-cosmic-dark .ai-message.error { border-left-color: var(--accent-error); }

html.theme-cosmic-dark .ai-message > code, html.theme-cosmic-dark .ai-message p > code, html.theme-cosmic-dark li > code { background-color: #10141f; border-color: #2f354d;}
html.theme-cosmic-dark .ai-message pre { background-color: #0d0c1d !important; border-color: #2f354d !important; }
html.theme-cosmic-dark .ai-message .ai-terminal-command-block, html.theme-cosmic-dark .ai-message .ai-markdown-code-runnable-wrapper { background-color: #10141f; border-color: #2f354d; }
html.theme-cosmic-dark .ai-message .ai-terminal-command-block pre { background-color: #0a0916 !important; border-color: #2a2f45 !important; }
html.theme-cosmic-dark .main-top-bar .panel-tabs { background-color: var(--bg-inset); }
html.theme-cosmic-dark .main-top-bar .panel-tabs button { color: var(--text-secondary); }
html.theme-cosmic-dark .main-top-bar .panel-tabs button:hover { background-color: var(--bg-hover); color: var(--text-primary); }
html.theme-cosmic-dark .main-top-bar .panel-tabs button.active-tab { background-color: var(--accent-secondary); color: var(--text-on-accent); }
html.theme-cosmic-dark .pane-content-area { background-color: var(--bg-app); }
html.theme-cosmic-dark .diff-current-content-viewer { background-color: var(--bg-inset) !important; border-color: var(--border-color-soft) !important; }
html.theme-cosmic-dark .diff-current-content-viewer pre { background-color: var(--bg-inset) !important; }
html.theme-cosmic-dark .diff-current-content-viewer code { color: var(--text-primary) !important; }
html.theme-cosmic-dark .diff-current-content-viewer .line-numbers .line-numbers-rows { background-color: var(--bg-inset) !important; border-right-color: var(--border-color-soft) !important; }
html.theme-cosmic-dark .diff-current-content-viewer .line-numbers-rows > span:before { color: var(--text-secondary) !important; }
html.theme-cosmic-dark #previewInternalIframe { background-color: var(--bg-app); }
html.theme-cosmic-dark .preview-placeholder { color: var(--text-secondary); }


html.theme-spooky {
    --bg-app: #100c08; --bg-surface: #1a140f; --bg-inset: #1f1a14; --bg-hover: #2e251b; --bg-active: #423629;
    --text-primary: #d4be98; --text-secondary: #928374; --text-headings: #f4e8c0; --text-link: #e69875;
    --accent-primary: #e69875; --accent-primary-hover: #f0a88a; --accent-primary-active: #d98863;
    --accent-secondary: #d3869b; --accent-success: #a9b665; --accent-warning: #dbbc7f;
    --accent-error: #ea6962; --border-color-strong: #000000; --border-color-soft: #3c3836;
}
html.theme-spooky .ai-message { border-left-color: var(--accent-secondary); }
html.theme-spooky .user-message { border-right-color: var(--accent-primary-active); }
html.theme-spooky .ai-message.info, html.theme-spooky .ai-message.thinking, html.theme-spooky .ai-message.error { border-left-color: var(--text-secondary); }
html.theme-spooky .ai-message.info.success { border-left-color: var(--accent-success); }
html.theme-spooky .ai-message.error { border-left-color: var(--accent-error); }

html.theme-spooky .toastify.toastify-warning { color: #282828 !important; }
html.theme-spooky .ai-message > code, html.theme-spooky .ai-message p > code, html.theme-spooky li > code { background-color: #1f1a14; color: var(--accent-primary); border-color: #3c3836; }
html.theme-spooky .ai-message pre { background-color: #100c08 !important; border-color: #3c3836 !important; }
html.theme-spooky .ai-message .ai-terminal-command-block, html.theme-spooky .ai-message .ai-markdown-code-runnable-wrapper { background-color: #1f1a14; border-color: #3c3836; }
html.theme-spooky .ai-message .ai-terminal-command-block pre { background-color: #100c08 !important; border-color: #2e251b !important; }
html.theme-spooky .main-top-bar .panel-tabs { background-color: var(--bg-inset); }
html.theme-spooky .main-top-bar .panel-tabs button { color: var(--text-secondary); }
html.theme-spooky .main-top-bar .panel-tabs button:hover { background-color: var(--bg-hover); color: var(--text-primary); }
html.theme-spooky .main-top-bar .panel-tabs button.active-tab { background-color: var(--accent-secondary); color: var(--text-on-accent); }
html.theme-spooky .pane-content-area { background-color: var(--bg-app); }
html.theme-spooky .diff-current-content-viewer { background-color: var(--bg-inset) !important; border-color: var(--border-color-soft) !important; }
html.theme-spooky .diff-current-content-viewer pre { background-color: var(--bg-inset) !important; }
html.theme-spooky .diff-current-content-viewer code { color: var(--text-primary) !important; }
html.theme-spooky .diff-current-content-viewer .line-numbers .line-numbers-rows { background-color: var(--bg-inset) !important; border-right-color: var(--border-color-soft) !important; }
html.theme-spooky .diff-current-content-viewer .line-numbers-rows > span:before { color: var(--text-secondary) !important; }
html.theme-spooky #previewInternalIframe { background-color: var(--bg-app); }
html.theme-spooky .preview-placeholder { color: var(--text-secondary); }


html.theme-rainbow {
    --bg-app: #1a1a1a; --bg-surface: #2a2a2a; --bg-inset: #222222; --bg-hover: #383838; --bg-active: #4d4d4d;
    --text-primary: #f0f0f0; --text-secondary: #b0b0b0; --text-headings: #ffffff; --text-link: #ff00ff;
    --accent-primary: #ff00ff; --accent-primary-hover: #f000f0; --accent-primary-active: #e000e0;
    --accent-secondary: #00ffff; --accent-success: #00ff00; --accent-warning: #ffff00;
    --accent-error: #ff0000; --border-color-strong: #000000; --border-color-soft: #404040;
}
html.theme-rainbow .ai-message { border-left-color: var(--accent-secondary); }
html.theme-rainbow .user-message { border-right-color: var(--accent-primary-active); }
html.theme-rainbow .ai-message.info, html.theme-rainbow .ai-message.thinking, html.theme-rainbow .ai-message.error { border-left-color: var(--text-secondary); }
html.theme-rainbow .ai-message.info.success { border-left-color: var(--accent-success); }
html.theme-rainbow .ai-message.error { border-left-color: var(--accent-error); }

html.theme-rainbow .toastify.toastify-warning,
html.theme-rainbow .toastify.toastify-success { color: #111 !important; }
html.theme-rainbow .ai-message > code, html.theme-rainbow .ai-message p > code, html.theme-rainbow li > code { background-color: #222222; color: var(--accent-secondary); border-color: #404040; }
html.theme-rainbow .ai-message pre { background-color: #1a1a1a !important; border-color: #404040 !important; }
html.theme-rainbow .ai-message .ai-terminal-command-block, html.theme-rainbow .ai-message .ai-markdown-code-runnable-wrapper { background-color: #222222; border-color: #404040; }
html.theme-rainbow .ai-message .ai-terminal-command-block pre { background-color: #1a1a1a !important; border-color: #383838 !important; }
html.theme-rainbow .main-top-bar .panel-tabs { background-color: var(--bg-inset); }
html.theme-rainbow .main-top-bar .panel-tabs button { color: var(--text-secondary); }
html.theme-rainbow .main-top-bar .panel-tabs button:hover { background-color: var(--bg-hover); color: var(--text-primary); }
html.theme-rainbow .main-top-bar .panel-tabs button.active-tab { background-color: var(--accent-secondary); color: var(--text-on-accent); }
html.theme-rainbow .pane-content-area { background-color: var(--bg-app); }
html.theme-rainbow .diff-current-content-viewer { background-color: var(--bg-inset) !important; border-color: var(--border-color-soft) !important; }
html.theme-rainbow .diff-current-content-viewer pre { background-color: var(--bg-inset) !important; }
html.theme-rainbow .diff-current-content-viewer code { color: var(--text-primary) !important; }
html.theme-rainbow .diff-current-content-viewer .line-numbers .line-numbers-rows { background-color: var(--bg-inset) !important; border-right-color: var(--border-color-soft) !important; }
html.theme-rainbow .diff-current-content-viewer .line-numbers-rows > span:before { color: var(--text-secondary) !important; }
html.theme-rainbow #previewInternalIframe { background-color: var(--bg-app); }
html.theme-rainbow .preview-placeholder { color: var(--text-secondary); }
/* --- END OF FILE style.css --- */